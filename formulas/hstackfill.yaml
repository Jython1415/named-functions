name: HSTACKFILL
version: 1.0.0

description: >
  Stacks two arrays horizontally, padding shorter arrays with a specified fill value
  to match dimensions. Prevents #N/A errors from mismatched heights.

parameters:
  - name: array1
    description: First array to stack
    example: "A1:C10"

  - name: array2
    description: Second array to stack
    example: "E1:F5"

  - name: fill_value
    description: Value to use for padding cells (use BLANK() for empty cells)
    example: "BLANK()"

formula: |
  LET(
    rows1, ROWS(array1),
    rows2, ROWS(array2),
    max_rows, MAX(rows1, rows2),
    padded1, IF(rows1 < max_rows,
                VSTACK(array1, MAKEARRAY(max_rows - rows1, COLUMNS(array1), LAMBDA(r, c, fill_value))),
                array1),
    padded2, IF(rows2 < max_rows,
                VSTACK(array2, MAKEARRAY(max_rows - rows2, COLUMNS(array2), LAMBDA(r, c, fill_value))),
                array2),
    HSTACK(padded1, padded2)
  )
